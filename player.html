<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Player</title>
  <style>
    html,body{height:100%;margin:0;background:#000;color:#fff;font-family:Arial,Helvetica,sans-serif}
    .wrap{max-width:1000px;margin:0 auto;padding:10px;box-sizing:border-box}
    .videoBox{background:#000; display:flex; align-items:center; justify-content:center; width:100%}
    video{width:100%; height:auto; max-width:900px; display:block}
    .msg{padding:18px;text-align:center}
    .err{color:#ff7373}
    a.btn{display:inline-block;margin-top:10px;padding:8px 14px;background:#00aaff;color:#000;border-radius:6px;text-decoration:none;font-weight:600}
  </style>
</head>
<body>
  <div class="wrap">
    <div id="playerArea" class="videoBox">
      <!-- Video akan dimasukkan di sini -->
    </div>
    <div id="message" class="msg" aria-live="polite"></div>
  </div>

<script>
(function(){
  // Ambil parameter ?v=...
  function getParam(name){
    try {
      const params = new URLSearchParams(location.search);
      return params.get(name);
    } catch(e){ return null; }
  }

  const raw = getParam('v') || '';
  const messageEl = document.getElementById('message');
  const playerArea = document.getElementById('playerArea');

  // Validasi sederhana: hanya izinkan "bay" + angka + .mp4
  const match = raw.match(/^bay(\d{1,3})\.mp4$/);
  if(!match){
    messageEl.innerHTML = '<div class="err">Video tidak ditemukan atau parameter salah.<br>Contoh benar: ?v=bay2.mp4</div>';
    // tampilkan link ke index jika mau
    messageEl.innerHTML += '<div><a class="btn" href="./index.html">Lihat daftar video</a></div>';
    return;
  }

  const filename = match[0]; // e.g. bay2.mp4
  // File disimpan di folder "videos/"
  const videoUrl = 'videos/' + filename;

  // Buat elemen video
  const video = document.createElement('video');
  video.setAttribute('controls', '');
  video.setAttribute('autoplay', '');
  video.setAttribute('muted', ''); // muted agar autoplay di browser modern
  video.setAttribute('playsinline', '');
  video.setAttribute('preload', 'auto');

  const source = document.createElement('source');
  source.src = videoUrl;
  source.type = 'video/mp4';
  video.appendChild(source);

  // Jika error memuat video -> tampilkan pesan dan link direct
  video.addEventListener('error', function(e){
    messageEl.innerHTML = '<div class="err">Gagal memuat video. Periksa apakah file tersedia di folder <code>/videos/</code>.</div>';
    messageEl.innerHTML += '<div>Buka video langsung: <a class="btn" href="' + videoUrl + '" target="_blank" rel="noopener">Buka video</a></div>';
    playerArea.innerHTML = '';
  });

  // Jika loadedmetadata -> hapus pesan
  video.addEventListener('loadedmetadata', function(){
    messageEl.innerHTML = '';
  });

  playerArea.appendChild(video);
})();
</script>
</body>
</html>
